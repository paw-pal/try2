import{_ as g,M as V,o as l,c as r,a as e,n as y,F as u,h as E,t as a,E as _,H as f,D as k,G as x,p as M,e as $,g as S,d as O,r as b,b as v}from"./index-46b816ce.js";import{p as U}from"./paginationComponent-d0b9efe6.js";const{VITE_URL:C,VITE_PATH:L}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"caiji_hexschool",BASE_URL:"/try2/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},R={props:["tempOrder","pages"],emits:["updateOrder"],data(){return{Modal:null,modalTempOrder:{},collapseOpen:!1}},methods:{updateOrder(){const o=this.modalTempOrder.id;this.$http.put(`${C}api/${L}/admin/order/${o}`,{data:this.modalTempOrder}).then(s=>{console.log(s),this.$emit("updateOrder",this.pages.current_page)}).catch(s=>{console.log(s)}),this.Modal.hide()}},watch:{tempOrder(){this.modalTempOrder=this.tempOrder;const o=Object.values(this.modalTempOrder.products);o.forEach((s,p)=>(console.log(s.product.title,s.product.title.length,p),s.product.title.length>30&&(o[p].product.title=s.product.title.substring(0,30)+"..."),o)),this.modalTempOrder.products=o}},mounted(){this.Modal=new V(this.$refs.modal)}},c=o=>(M("data-v-ccdf030d"),o=o(),$(),o),D={class:"modal",tabindex:"-1",ref:"modal"},A={class:"modal-dialog modal-lg"},P={class:"modal-content"},N=c(()=>e("div",{class:"modal-header bg-dark"},[e("h5",{class:"modal-title text-white"},"編輯訂單"),e("i",{class:"bi bi-x-lg bg-dark text-white cursor-pointer fs-5 fw-bold","data-bs-dismiss":"modal"})],-1)),H={class:"modal-body"},j={class:"container"},B={class:"row"},q={class:"col-12"},F=c(()=>e("p",{class:"m-0"},"訂購商品",-1)),J={class:"collapse",id:"collapseOrder"},z={class:"card card-body border border-top-0 rounded-0 rounded-bottom"},G={class:"p-0"},K=["src","alt"],Q={class:"d-flex flex-d flex-column justify-content-between w-50"},W={class:"ms-4"},X={class:"ms-auto mt-auto mb-0"},Y={class:"col-12"},Z={class:"my-3"},ee=c(()=>e("label",{for:"input-orderCreatNum",class:"form-label"},"訂單編號",-1)),se={class:"row"},te={class:"col-6"},oe={class:"mb-3"},de=c(()=>e("label",{for:"input-orderName",class:"form-label"},"客戶姓名",-1)),le={class:"col-6"},re={class:"mb-3"},ae=c(()=>e("label",{for:"input-orderEmail",class:"form-label"},"客戶信箱",-1)),ie={class:"row"},ne={class:"col-6"},ce={class:"mb-3"},pe=c(()=>e("label",{for:"input-orderPay",class:"form-label"},"付款",-1)),me=["value"],_e=["value"],ue={class:"col-6"},he={class:"mb-3"},Oe=c(()=>e("label",{class:"form-label"},"訂單狀態",-1)),fe=S('<option value="" data-v-ccdf030d>未確認</option><option value="待付款" data-v-ccdf030d>待付款</option><option value="待出貨" data-v-ccdf030d>待出貨</option><option value="已出貨" data-v-ccdf030d>已出貨</option><option value="待退貨" data-v-ccdf030d>待退貨</option><option value="已退貨" data-v-ccdf030d>已退貨</option><option value="已完成" data-v-ccdf030d>已完成</option>',7),be=[fe],ve={class:"modal-footer"},ge=c(()=>e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1));function Te(o,s,p,T,t,i){var m,h;return l(),r("div",D,[e("div",A,[e("div",P,[N,e("div",H,[e("div",j,[e("div",B,[e("div",q,[e("div",{class:y(["border rounded-top p-3 m-0 d-flex justify-content-between align-items-center cursor-pointer",t.collapseOpen?"":"rounded-bottom"]),"data-bs-toggle":"collapse",href:"#collapseOrder","aria-expanded":"false","aria-controls":"collapseOrder",onClick:s[0]||(s[0]=d=>t.collapseOpen=!t.collapseOpen)},[F,e("i",{class:y(["bi bi-chevron-down fs-5 cursor-pointer",{iconTransform:t.collapseOpen}])},null,2)],2),e("div",J,[e("div",z,[e("ul",G,[(l(!0),r(u,null,E(t.modalTempOrder.products,d=>(l(),r("li",{key:d.id,class:"d-flex mb-3"},[e("img",{src:d.product.imageUrl,alt:d.product.title,class:"orderImg me-2"},null,8,K),e("div",Q,[e("p",null,a(d.product.title),1),e("div",null,[e("span",null,"$ "+a(d.product.price),1),e("span",W,"x "+a(d.qty),1)])]),e("p",X,"NT$"+a(d.total),1)]))),128))])])])]),e("div",Y,[e("div",Z,[ee,_(e("input",{type:"text",class:"form-control",id:"input-orderCreatNum","onUpdate:modelValue":s[1]||(s[1]=d=>t.modalTempOrder.create_at=d),disabled:""},null,512),[[f,t.modalTempOrder.create_at]])])])]),e("div",se,[t.modalTempOrder.user?(l(),r(u,{key:0},[e("div",te,[e("div",oe,[de,_(e("input",{type:"text",class:"form-control",id:"input-orderName","onUpdate:modelValue":s[2]||(s[2]=d=>t.modalTempOrder.user.name=d)},null,512),[[f,t.modalTempOrder.user.name]]),e("p",null,a((h=(m=t.modalTempOrder)==null?void 0:m.user)==null?void 0:h.name),1)])]),e("div",le,[e("div",re,[ae,_(e("input",{type:"email",class:"form-control",id:"input-orderEmail","onUpdate:modelValue":s[3]||(s[3]=d=>t.modalTempOrder.user.email=d)},null,512),[[f,t.modalTempOrder.user.email]])])])],64)):k("",!0)]),e("div",ie,[e("div",ne,[e("div",ce,[pe,_(e("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":s[4]||(s[4]=d=>t.modalTempOrder.is_paid=d)},[e("option",{value:t.modalTempOrder.is_paid},a(t.modalTempOrder.is_paid?"已付款":"未付款"),9,me),e("option",{value:!t.modalTempOrder.is_paid},a(t.modalTempOrder.is_paid?"未付款":"已付款"),9,_e)],512),[[x,t.modalTempOrder.is_paid]])])]),e("div",ue,[e("div",he,[Oe,_(e("select",{class:"form-select","aria-label":"Default select example","onUpdate:modelValue":s[5]||(s[5]=d=>t.modalTempOrder.step=d)},be,512),[[x,t.modalTempOrder.step]])])])])])]),e("div",ve,[ge,e("button",{type:"button",class:"btn btn-primary",onClick:s[6]||(s[6]=(...d)=>i.updateOrder&&i.updateOrder(...d))},"Save changes")])])])],512)}const ye=g(R,[["render",Te],["__scopeId","data-v-ccdf030d"]]),{VITE_URL:xe,VITE_PATH:Ve}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"caiji_hexschool",BASE_URL:"/try2/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Ee={props:["tempOrder"],emits:["delOrder"],methods:{delOrder(){const o=this.tempOrder.id;this.$http.delete(`${xe}api/${Ve}/admin/order/${o}`).then(s=>{console.log(s),this.$emit("delOrder")}).catch(s=>{console.log(s)}),this.Modal.hide()}},mounted(){this.Modal=new V(this.$refs.modal)}},Me={class:"modal",tabindex:"-1",ref:"modal"},$e={class:"modal-dialog"},we={class:"modal-content"},Ie=e("div",{class:"modal-header bg-dark text-white"},[e("h5",{class:"modal-title"},"刪除商品"),e("i",{class:"bi bi-x-lg bg-dark text-white cursor-pointer fs-5 fw-bold","data-bs-dismiss":"modal"})],-1),ke={class:"modal-body"},Se={class:"mb-2"},Ue=e("p",{class:"text-danger fs-additional"},"刪除後即無法復原",-1),Ce={class:"modal-footer"},Le=e("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"取消",-1);function Re(o,s,p,T,t,i){return l(),r("div",Me,[e("div",$e,[e("div",we,[Ie,e("div",ke,[e("p",Se,[O(" 你要刪除"),e("strong",null,a(p.tempOrder.id),1),O("嗎? ")]),Ue]),e("div",Ce,[Le,e("button",{type:"button",class:"btn btn-primary",onClick:s[0]||(s[0]=(...m)=>i.delOrder&&i.delOrder(...m))},"確認")])])])],512)}const De=g(Ee,[["render",Re]]);const{VITE_URL:Ae,VITE_PATH:Pe}={VITE_URL:"https://vue3-course-api.hexschool.io/v2/",VITE_PATH:"caiji_hexschool",BASE_URL:"/try2/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Ne={data(){return{orders:[],tempOrder:{},pages:{}}},components:{OrderModal:ye,delOrderModalVue:De,paginationComponent:U},methods:{getOrdersList(o=1){this.$http.get(`${Ae}api/${Pe}/admin/orders?page=${o}`).then(s=>{console.log(s),this.pages=s.data.pagination,this.orders=s.data.orders}).catch(s=>{console.log(s)})},addTempOrder(o,s){this.tempOrder=JSON.parse(JSON.stringify(s)),o==="edit"?(this.tempOrder.step===void 0&&(this.tempOrder.step=""),this.$refs.orderModal.Modal.show()):o==="del"&&this.$refs.delOrderModal.Modal.show()}},mounted(){this.getOrdersList()}},w=o=>(M("data-v-23e67360"),o=o(),$(),o),He=w(()=>e("h2",null,"訂單",-1)),je={class:"table table-hover"},Be=w(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"訂單編號"),e("th",{scope:"col"},"客戶名字"),e("th",{scope:"col"},"客戶信箱"),e("th",{scope:"col"},"付款"),e("th",{scope:"col"},"狀態"),e("th",{scope:"col"},"編輯")])],-1)),qe={key:0,class:"bi bi-check-circle-fill fs-5 text-success"},Fe={key:1},Je={key:1,class:"m-0"},ze=["onClick"],Ge=["onClick"];function Ke(o,s,p,T,t,i){const m=b("OrderModal"),h=b("delOrderModalVue"),d=b("paginationComponent");return l(),r(u,null,[v(m,{ref:"orderModal",tempOrder:t.tempOrder,onUpdateOrder:i.getOrdersList,pages:t.pages},null,8,["tempOrder","onUpdateOrder","pages"]),v(h,{ref:"delOrderModal",tempOrder:t.tempOrder,onDelOrder:i.getOrdersList},null,8,["tempOrder","onDelOrder"]),He,e("table",je,[Be,e("tbody",null,[(l(!0),r(u,null,E(t.orders,(n,Qe)=>(l(),r("tr",{key:n+1,class:"align-middle"},[e("td",null,a(n.create_at),1),e("td",null,a(n.user.name),1),e("td",null,a(n.user.email),1),e("td",null,[n.is_paid?(l(),r("i",qe)):(l(),r("span",Fe,"–"))]),e("td",null,[n.step?(l(),r(u,{key:0},[O(a(n.step),1)],64)):(l(),r("p",Je,"未確認"))]),e("td",null,[e("i",{class:"bi bi-pencil-square fs-5 pe-1 icon-edit cursor-pointer",onClick:I=>i.addTempOrder("edit",n)},null,8,ze),O(" | "),e("i",{class:"bi bi-trash-fill fs-5 ps-1 icon-delete cursor-pointer",onClick:I=>i.addTempOrder("del",n)},null,8,Ge)])]))),128))])]),v(d,{pages:t.pages,onChangePage:i.getOrdersList},null,8,["pages","onChangePage"])],64)}const Ye=g(Ne,[["render",Ke],["__scopeId","data-v-23e67360"]]);export{Ye as default};
